{% extends 'base.html' %}

{% block body %}
<div class="row">
	<div class="col">
		<table class="table table-striped table-sm">
			<thead>
				<tr>
					<th scope="col">uid</th>
					<th scope="col">login name</th>
					<th scope="col">display name</th>
					<th scope="col">
						<p class="text-right">
							<a type="button" class="btn btn-primary" href="{{ url_for("user.show") }}">
								<i class="fa fa-plus" aria-hidden="true"></i> New
							</a>
							<button type="button" class="btn btn-primary" data-toggle="modal" data-target="#csvimport">
								<i class="fa fa-file-csv" aria-hidden="true"></i> CSV import
							</button>
						</p>
					</th>
				</tr>
			</thead>
			<tbody>
				{% for user in users|sort(attribute="uid") %}
				<tr id="user-{{ user.uid }}">
					<th scope="row">
						{{ user.uid }}
					</th>
					<td>
						<a href="{{ url_for("user.show", uid=user.uid) }}">
							{{ user.loginname }}
						</a>
					</td>
					<td>
						{{ user.displayname }}
					</td>
					<td>
						<p class="text-right">
							<a href="{{ url_for("user.show", uid=user.uid) }}" class="btn btn-primary">
								<i class="fa fa-edit" aria-hidden="true"></i> Edit
							</a>
						</p>
					</td>
				</tr>
				{% endfor %}
			</tbody>
		</table>
	</div>
</div>

<div class="modal fade" id="csvimport" tabindex="-1" role="dialog" aria-hidden="true">
	<form action="{{ url_for("user.csvimport") }}" method="POST">
	<div class="modal-dialog" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title" id="exampleModalLabel">Import a csv formated list of users</h5>
				<button type="button" class="close" data-dismiss="modal" aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
			</div>
			<div class="modal-body">
				<p>
					The format should be "loginname,mailaddres,groupid1;groupid2;".
					Neither setting the display name, nor setting roles or passwords is supported (yet).
					Example:
				</p>
				<pre>
testuser1,foobar@example.com,5;2;6
testuser5,foobsdfar@example.com,
testuser5,foobadfar@example.com,0;5;2
testuser2,foobaadsfr@example.com,5;2
				</pre>
				<textarea rows="10" class="form-control" name="csv"></textarea>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
				<button type="submit" class="btn btn-primary">Import</button>
			</div>
		</div>
	</div>
	</form>
</div>
{% endblock %}
